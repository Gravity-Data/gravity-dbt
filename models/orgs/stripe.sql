{{ config(materialized='view') }}

select
    _id,
    monthlyAlottedDatasetRuns,
    organisation as organisationid,
    currentDatasetRunCount,
    monthlyDatasetRunCount,
    totalDatasetRunCount,
    userDatasetRunLimit,
    accountOwner,
    customerId,
    allowed,
    version,
    special,
    trialEndNotificationSent,
    trialing,
    timestamp_seconds(currentPeriodEnd) as currentPeriodEnd,
    timestamp_seconds(currentPeriodStart) as currentPeriodStart,
    lastPriceId,
    lastProductId,
    subscriptionId,
    subscriptionStartDate,
    subscriptionStatus,
    subscriptionInterval,
    endedAt,
    gravity_id,
    gravity_inserted,
    gravity_updated
from {{ source('raw', 'MongoStripe') }}